/*
 MIT license (MIT-LICENSE.txt)
 @version 1.0
 @requires jquery.uri.js
 @requires jquery.xmlns.js
 @requires jquery.curie.js
 @requires jquery.datatype.js
 @requires jquery.rdf.js
*/
(function(f){var r={rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",xsd:"http://www.w3.org/2001/XMLSchema#",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},z=r.rdf+"XMLLiteral",G=f.fn.curie.defaults,T=["alternate","appendix","bookmark","cite","chapter","contents","copyright","first","glossary","help","icon","index","last","license","meta","next","p3pv1","prev","role","section","stylesheet","subsection","start","top","up"],v=/\s([^ =]+)\s*=\s*(?:"([^"]*)"|'([^']*)'|([^ >]+))/g,
M=RegExp("^[A-Za-z\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u00ff\u0100-\u0131\u0134-\u013e\u0141-\u0148\u014a-\u017e\u0180-\u01c3\u01cd-\u01f0\u01f4-\u01f5\u01fa-\u0217\u0250-\u02a8\u02bb-\u02c1\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03ce\u03d0-\u03d6\u03da\u03dc\u03de\u03e0\u03e2-\u03f3\u0401-\u040c\u040e-\u044f\u0451-\u045c\u045e-\u0481\u0490-\u04c4\u04c7-\u04c8\u04cb-\u04cc\u04d0-\u04eb\u04ee-\u04f5\u04f8-\u04f9\u0531-\u0556\u0559\u0561-\u0586\u05d0-\u05ea\u05f0-\u05f2\u0621-\u063a\u0641-\u064a\u0671-\u06b7\u06ba-\u06be\u06c0-\u06ce\u06d0-\u06d3\u06d5\u06e5-\u06e6\u0905-\u0939\u093d\u0958-\u0961\u0985-\u098c\u098f-\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09dc-\u09dd\u09df-\u09e1\u09f0-\u09f1\u0a05-\u0a0a\u0a0f-\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32-\u0a33\u0a35-\u0a36\u0a38-\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8b\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2-\u0ab3\u0ab5-\u0ab9\u0abd\u0ae0\u0b05-\u0b0c\u0b0f-\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32-\u0b33\u0b36-\u0b39\u0b3d\u0b5c-\u0b5d\u0b5f-\u0b61\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99-\u0b9a\u0b9c\u0b9e-\u0b9f\u0ba3-\u0ba4\u0ba8-\u0baa\u0bae-\u0bb5\u0bb7-\u0bb9\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c60-\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cde\u0ce0-\u0ce1\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d60-\u0d61\u0e01-\u0e2e\u0e30\u0e32-\u0e33\u0e40-\u0e45\u0e81-\u0e82\u0e84\u0e87-\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa-\u0eab\u0ead-\u0eae\u0eb0\u0eb2-\u0eb3\u0ebd\u0ec0-\u0ec4\u0f40-\u0f47\u0f49-\u0f69\u10a0-\u10c5\u10d0-\u10f6\u1100\u1102-\u1103\u1105-\u1107\u1109\u110b-\u110c\u110e-\u1112\u113c\u113e\u1140\u114c\u114e\u1150\u1154-\u1155\u1159\u115f-\u1161\u1163\u1165\u1167\u1169\u116d-\u116e\u1172-\u1173\u1175\u119e\u11a8\u11ab\u11ae-\u11af\u11b7-\u11b8\u11ba\u11bc-\u11c2\u11eb\u11f0\u11f9\u1e00-\u1e9b\u1ea0-\u1ef9\u1f00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2126\u212a-\u212b\u212e\u2180-\u2182\u3041-\u3094\u30a1-\u30fa\u3105-\u312c\uac00-\ud7a3\u4e00-\u9fa5\u3007\u3021-\u3029_][-A-Z_a-z\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd\u10000-\uefffF.0-9\u00b7\u0300-\u036f\u203f-\u2040]*$"),
N=f.rdf.resource("<>"),w=function(a){var b,d,c,g={},e={};a=a[0];e[":length"]=0;if(a.attributes&&a.attributes.getNamedItemNS){c=a.attributes;for(a=0;a<c.length;a+=1){b=c[a];if(/^xmlns(:(.+))?$/.test(b.nodeName)&&b.nodeValue!==""){d=/^xmlns(:(.+))?$/.exec(b.nodeName)[2]||"";if(M.test(d)&&(d!=="xml"||b.nodeValue===r.xml)&&(b.nodeValue!==r.xml||d==="xml")&&d!=="xmlns"&&b.nodeValue!==r.xmlns){e[d]=f.uri(b.nodeValue);e[":length"]+=1}}else if(/rel|rev|lang|xml:lang|about|href|src|resource|property|typeof|content|datatype/.test(b.nodeName))g[b.nodeName]=
b.nodeValue===null?undefined:b.nodeValue}}else{a=/<[^>]+>/.exec(a.outerHTML);for(b=v.exec(a);b!==null;){d=b[1];c=b[2]||b[3]||b[4];if(/^xmlns/.test(d)&&d!=="xmlns:"&&c!==""){d=/^xmlns(:(.+))?$/.exec(d)[2]||"";if(M.test(d)&&(d!=="xml"||b.nodeValue===r.xml)&&(b.nodeValue!==r.xml||d==="xml")&&d!=="xmlns"&&b.nodeValue!==r.xmlns){e[d]=f.uri(c);e[":length"]+=1}}else if(/about|href|src|resource|property|typeof|content|datatype|rel|rev|lang|xml:lang/.test(d)){b=g;d=d;c=c;var h="",j=void 0,m=void 0;if(/&/.test(c)){for(;c.length>
0;){j=/([^&]*)(&([^;]+);)(.*)/g.exec(c);if(j===null){h+=c;break}h+=j[1];m=j[3];c=j[4];if(m.charAt(0)==="#")h+=m.charAt(1)==="x"?String.fromCharCode(parseInt(m.substring(2),16)):String.fromCharCode(parseInt(m.substring(1),10));else switch(m){case "amp":h+="&";break;case "nbsp":h+=String.fromCharCode(160);break;case "quot":h+='"';break;case "apos":h+="'";break;default:h+="&"+m+";"}}c=h}else c=c;b[d]=c}b=v.exec(a)}v.lastIndex=0}return{atts:g,namespaces:e}},O=function(a,b){var d=a[0].getAttribute(b);
return d===null?undefined:d},P=function(a){return f.rdf.resource(a)},H=function(a,b,d,c){if(a.substring(0,2)==="_:"){if(!d)return f.rdf.blank(a)}else try{return P(f.curie(a,c))}catch(g){}},A=function(a,b,d){var c=/^\[(.*)\]$/.exec(a),g=d.base||b.base();return c?H(c[1],b,false,d):P(f.uri(a,g))},D=function(a,b,d,c){var g,e,h=[];a=a&&a.split?a.split(/[ \t\n\r\x0C]+/g):[];for(g=0;g<a.length;g+=1)if(a[g]!==""){e=H(a[g],b,d,c);e!==undefined&&h.push(e)}return h},E=function(a,b,d){var c,g,e=[];b=b.type===
"uri"?b:f.rdf.resource(b,d);a=a&&a.split?a.split(/\s+/):[];for(c=0;c<a.length;c+=1)if(a[c]!==""){g=H(a[c],null,false,d);g!==b&&e.push(a[c])}return e.reverse().join(" ")},B=function(a,b,d){var c,g;b=b||{};g=b.atts||w(a).atts;c=d===undefined?g.rel!==undefined||g.rev!==undefined:d;d=g.resource;d=d===undefined?g.href:d;if(d===undefined)d=c?f.rdf.blank("[]"):d;else{b=b.curieOptions||f.extend({},G,{namespaces:a.xmlns()});d=A(d,a,b)}return d},u=function(a,b,d){var c,g,e,h=false;b=b||{};c=b.atts||w(a).atts;
g=b.curieOptions||f.extend({},G,{namespaces:a.xmlns(),base:a.base()});d=d===undefined?c.rel!==undefined||c.rev!==undefined:d;if(c.about!==undefined)e=A(c.about,a,g);if(e===undefined&&c.src!==undefined)e=A(c.src,a,g);if(!d&&e===undefined&&c.resource!==undefined)e=A(c.resource,a,g);if(!d&&e===undefined&&c.href!==undefined)e=A(c.href,a,g);if(e===undefined)if(/^(head|body)$/i.test(a[0].nodeName))e=N;else if(c["typeof"]!==undefined)e=f.rdf.blank("[]");else if(a[0].parentNode.nodeType===1){e=b.object||
B(a.parent())||u(a.parent()).subject;h=!d&&c.property===undefined}else e=N;return{subject:e,skip:h}},F=function(a,b){var d;b=b||{};if(b.atts)d=(d=b.atts.lang)||b.atts["xml:lang"];else{d=a[0].getAttribute("lang");try{d=d===null||d===""?a[0].getAttribute("xml:lang"):d}catch(c){}d=d===null||d===""?undefined:d}if(d===undefined)if(b.lang)d=b.lang;else if(a[0].parentNode.nodeType===1)d=F(a.parent());return d},U=function(a){switch(a){case "<":return"&lt;";case '"':return"&quot;";case "&":return"&amp;"}},
I=function(a,b){var d,c="",g,e,h,j,m;a.contents().each(function(){var p=f(this),l=p[0];if(l.nodeType===1){h=l.nodeName.toLowerCase();c+="<"+h;if(l.outerHTML){m=/<[^>]+>/.exec(l.outerHTML);for(e=v.exec(m);e!==null;){if(!/^jQuery/.test(e[1])){c+=" "+e[1]+"=";c+=e[2]?e[3]:'"'+e[1]+'"'}e=v.exec(m)}v.lastIndex=0}else{g=l.attributes;for(d=0;d<g.length;d+=1){e=g.item(d);c+=" "+e.nodeName+'="';c+=e.nodeValue.replace(/[<"&]/g,U);c+='"'}}if(!b){j=p.xmlns("");if(j!==undefined&&p.attr("xmlns")===undefined)c+=
' xmlns="'+j+'"'}c+=">";c+=I(p,true);c+="</"+h+">"}else if(l.nodeType===8){c+="<!--";c+=l.nodeValue;c+="--\>"}else c+=l.nodeValue});return c},J=function(a){var b,d,c,g,e,h,j,m,p,l,n=[],s,t,q,x,Q=this.children();a=a||{};j=a.forward||[];h=a.backward||[];s=a.callback||function(){return this};t=w(this);q=t.atts;a.atts=q;x=a.namespaces||this.xmlns();if(t.namespaces[":length"]>0){x=f.extend({},x);for(b in t.namespaces)if(b!==":length")x[b]=t.namespaces[b]}a.curieOptions=f.extend({},G,{reserved:[],namespaces:x,
base:this.base()});t=f.extend({},a.curieOptions,{reserved:T});d=u(this,a);g=F(this,a);if(d.skip){p=a.forward;l=a.backward;d=a.subject;c=a.object}else{d=d.subject;if(j.length>0||h.length>0){m=a.subject||u(this.parent()).subject;for(b=0;b<j.length;b+=1){e=f.rdf.triple(m,j[b],d,{source:this[0]});e=s.call(e,this.get(0),e);if(e!==undefined&&e!==null)n=n.concat(e)}for(b=0;b<h.length;b+=1){e=f.rdf.triple(d,h[b],m,{source:this[0]});e=s.call(e,this.get(0),e);if(e!==undefined&&e!==null)n=n.concat(e)}}c=B(this,
a);j=D(q["typeof"],this,false,a.curieOptions);for(b=0;b<j.length;b+=1){e=f.rdf.triple(d,f.rdf.type,j[b],{source:this[0]});e=s.call(e,this.get(0),e);if(e!==undefined&&e!==null)n=n.concat(e)}j=D(q.property,this,true,a.curieOptions);if(j.length>0){b=q.datatype;e=q.content;h=this.text().replace(/"/g,'\\"');if(b!==undefined&&b!==""){b=f.curie(b,a.curieOptions);a=b.toString()===z?f.rdf.literal(I(this),{datatype:z}):e!==undefined?f.rdf.literal(e,{datatype:b}):f.rdf.literal(h,{datatype:b})}else if(e!==undefined)a=
g===undefined?f.rdf.literal('"'+e+'"'):f.rdf.literal(e,{lang:g});else if(Q.length===0||b===""){g=F(this,a);a=g===undefined?f.rdf.literal('"'+h+'"'):f.rdf.literal(h,{lang:g})}else a=f.rdf.literal(I(this),{datatype:z});for(b=0;b<j.length;b+=1){e=f.rdf.triple(d,j[b],a,{source:this[0]});e=s.call(e,this.get(0),e);if(e!==undefined&&e!==null)n=n.concat(e)}}p=D(q.rel,this,true,t);l=D(q.rev,this,true,t);if(q.resource!==undefined||q.href!==undefined){if(p!==undefined)for(b=0;b<p.length;b+=1){e=f.rdf.triple(d,
p[b],c,{source:this[0]});e=s.call(e,this.get(0),e);if(e!==undefined&&e!==null)n=n.concat(e)}p=[];if(l!==undefined)for(b=0;b<l.length;b+=1){e=f.rdf.triple(c,l[b],d,{source:this[0]});e=s.call(e,this.get(0),e);if(e!==undefined&&e!==null)n=n.concat(e)}l=[]}}Q.each(function(){n=n.concat(J.call(f(this),{forward:p,backward:l,subject:d,object:c||d,lang:g,namespaces:x,callback:s}))});return n},K=1,k=function(a,b,d){var c;try{c=a.createCurie(d)}catch(g){if(d.toString()===z){a.attr("xmlns:rdf",r.rdf);c="rdf:XMLLiteral"}else{c=
/^(.+[\/#])([^#]+)$/.exec(d);a.attr("xmlns:ns"+K,c[1]);c="ns"+K+":"+c[2];K+=1}}d=O(a,b);if(d!==undefined)f.inArray(c,d.split(/\s+/))===-1&&a.attr(b,d+" "+c);else a.attr(b,c)},R=function(a,b,d){d=d.type==="bnode"?"[_:"+d.id+"]":f(a).base().relative(d.value);a.attr(b,d)},o=function(a,b){var d=u(a).subject;b!==d&&R(a,"about",b);a.removeData("rdfa.subject")},y=function(a,b){var d=B(a);b!==d&&R(a,"resource",b);a.removeData("rdfa.objectResource")},S=function(a,b){a.wrapInner("<span></span>").children("span").attr("lang",
b);return a},C=function(a){var b,d,c,g,e,h,j;e=this.xmlns();c=this;d=w(this).atts;if(typeof a==="string")a=f.rdf.triple(a,{namespaces:e,base:this.base()});else if(a.rdfquery){C.call(this,a.sources().get(0));return this}else if(a.length){for(c=0;c<a.length;c+=1)C.call(this,a[c]);return this}b=d.rel!==undefined||d.rev!==undefined||d.property!==undefined||d["typeof"]!==undefined;if(a.object.type!=="literal"){g=u(this,{atts:d},true).subject;h=B(this,{atts:d},true);d=!b&&d.resource===undefined;e=g===a.subject;
j=h===a.object;if(a.property===f.rdf.type)if(e)k(this,"typeof",a.object.value);else if(b){c=this.wrapInner("<span />").children("span");k(c,"typeof",a.object.value);h!==a.subject&&o(c,a.subject)}else{k(this,"typeof",a.object.value);o(this,a.subject)}else if(e)if(j)k(this,"rel",a.property.value);else if(d||!b){k(this,"rel",a.property.value);y(this,a.object)}else{c=this.wrap("<span />").parent();k(c,"rev",a.property.value);o(c,a.object)}else if(g===a.object)if(h===a.subject)k(this,"rev",a.property.value);
else if(d||!b){k(this,"rev",a.property.value);y(this,a.subject)}else{c=this.wrap("<span />").parent();k(c,"rel",a.property.value);o(c,a.subject)}else if(j)if(b){c=this.wrapInner("<span />").children("span");k(c,"rev",a.property.value);y(c,a.subject);c=c.wrapInner("<span />").children("span");o(c,a.object);c=this}else{o(this,a.subject);k(this,"rel",a.property.value)}else if(h===a.subject)if(b){c=this.wrapInner("<span />").children("span");k(c,"rel",this.property.value);y(c,a.object);c=c.wrapInner("<span />").children("span");
o(c,h);c=this}else{o(this,a.object);k(this,"rev",a.property.value)}else if(b){c=this.wrapInner("<span />").children("span");k(c,"rel",a.property.value);o(c,a.subject);y(c,a.object);if(c.children("*").length>0){c=this.wrapInner("<span />").children("span");o(c,g)}c=this}else{k(c,"rel",a.property.value);o(this,a.subject);y(this,a.object);if(this.children("*").length>0){c=this.wrapInner("<span />").children("span");o(c,g);c=this}}}else{g=u(this,{atts:d}).subject;h=B(this,{atts:d});e=g===a.subject;b=
this.text()!==a.object.value;if(d.property!==undefined){h=d.content;j=h!==undefined?h===a.object.value:!b;if(e&&j)k(this,"property",a.property.value);else{c=this.wrapInner("<span />").children("span");return C.call(c,a)}}else{if(h===a.subject){c=this.wrapInner("<span />").children("span");return C.call(c,a)}k(this,"property",a.property.value);o(this,a.subject);if(b)a.object.datatype&&a.object.datatype.toString()===z?this.html(a.object.value):this.attr("content",a.object.value);e=F(this);if(a.object.lang){if(e!==
a.object.lang){this.attr("lang",a.object.lang);b&&S(this,e)}}else if(a.object.datatype)k(this,"datatype",a.object.datatype);else{b||this.attr("datatype","");if(e!==undefined){this.attr("lang","");b&&S(this,e)}}}}this.parents().andSelf().trigger("rdfChange");return c},L=function(a){var b,d,c;c=this.xmlns();b=w(this).atts;if(a.length){for(i=0;i<a.length;i+=1)L.call(this,a[i]);return this}if(hasRDFa=(hasRelation=b.rel!==undefined||b.rev!==undefined)||b.property!==undefined||b["typeof"]!==undefined){if(a.property!==
undefined){if(b.property!==undefined){d=E(b.property,a.property,{namespaces:c});d===""?this.removeAttr("property"):this.attr("property",d)}if(b.rel!==undefined){d=E(b.rel,a.property,{namespaces:c});d===""?this.removeAttr("rel"):this.attr("rel",d)}if(b.rev!==undefined){d=E(b.rev,a.property,{namespaces:c});d===""?this.removeAttr("rev"):this.attr("rev",d)}}if(a.type!==undefined)if(b["typeof"]!==undefined){c=E(b["typeof"],a.type,{namespaces:c});c===""?this.removeAttr("typeof"):this.attr("typeof",c)}if(b.property===
this.attr("property")&&b.rel===this.attr("rel")&&b.rev===this.attr("rev")&&b["typeof"]===this.attr("typeof"))return L.call(this.parent(),a)}this.parents().andSelf().trigger("rdfChange");return this};f.fn.rdfa=function(a){if(a===undefined){var b=f.map(f(this),function(d){return J.call(f(d))});return f.rdf({triples:b})}else{f(this).each(function(){C.call(f(this),a)});return this}};f.fn.removeRdfa=function(a){f(this).each(function(){L.call(f(this),a)});return this};f.rdf.gleaners.push(function(a){var b;
if(a&&a.about!==undefined){b=w(this).atts;return a.about===null?b.property!==undefined||b.rel!==undefined||b.rev!==undefined||b["typeof"]!==undefined:u(this,{atts:b}).subject.value===a.about}else if(a&&a.type!==undefined){b=O(this,"typeof");if(b!==undefined)return a.type===null?true:this.curie(b)===a.type;return false}else return J.call(this,a)})})(jQuery);
