/*
 MIT license (MIT-LICENSE.txt)
 @version 1.0
*/
(function(d){var s={},t={},u={},j={},k={},M=/^<(([^>]|\\>)*)>$/,N=/^("""((\\"|[^"])*)"""|"((\\"|[^"])*)")(@([a-z]+(-[a-z0-9]+)*)|\^\^(.+))?$/,D=/(("""((\\"|[^"])*)""")|("(\\"|[^"]|)*")|(<(\\>|[^>])*>)|\S)+/g,E=databankSeed=(new Date).getTime()%1E3,y={},r={},z=function(a,b){if(typeof a==="string")try{return d.rdf.resource(a,b)}catch(c){try{return d.rdf.blank(a,b)}catch(e){throw"Bad Triple: Subject "+a+" is not a resource: "+e;}}else return a},F=function(a,b){if(a==="a")return d.rdf.type;else if(typeof a===
"string")try{return d.rdf.resource(a,b)}catch(c){throw"Bad Triple: Property "+a+" is not a resource: "+c;}else return a},A=function(a,b){if(typeof a==="string")try{return d.rdf.resource(a,b)}catch(c){try{return d.rdf.blank(a,b)}catch(e){try{return d.rdf.literal(a,b)}catch(f){throw"Bad Triple: Object "+a+" is not a resource or a literal "+f;}}}else return a},B=function(a,b,c){if(typeof b==="string"){b=b.substring(1);if(c[b]&&c[b]!==a)return null;else{c[b]=a;return c}}else return b===a?c:null},O=function(a,
b){if(a.union===undefined)if(b.subject.type!==undefined){if(a.subjectIndex[b.subject]===undefined)return[];return d.map(a.subjectIndex[b.subject],function(c){var e=b.exec(c);return e===null?null:{bindings:e,triples:[c]}})}else if(b.object.type==="uri"||b.object.type==="bnode"){if(a.objectIndex[b.object]===undefined)return[];return d.map(a.objectIndex[b.object],function(c){var e=b.exec(c);return e===null?null:{bindings:e,triples:[c]}})}else if(b.property.type!==undefined){if(a.propertyIndex[b.property]===
undefined)return[];return d.map(a.propertyIndex[b.property],function(c){var e=b.exec(c);return e===null?null:{bindings:e,triples:[c]}})}return d.map(a.triples(),function(c){var e=b.exec(c);return e===null?null:{bindings:e,triples:[c]}})},G=function(a,b,c){return d.map(a,function(e){var f=d.map(b,function(g){var h,i,l=true;for(h in g.bindings){i=g.bindings[h];if(!(e.bindings[h]===undefined||e.bindings[h]===i)){l=false;break}}return l?g:null});return f.length>0?d.map(f,function(g){return{bindings:d.extend({},
e.bindings,g.bindings),triples:d.unique(e.triples.concat(g.triples))}}):c?e:null})},H=function(a,b){var c,e,f;if(b.filterExp!==undefined&&!d.isFunction(b.filterExp))if(a.union===undefined){c=typeof b.filterExp.subject==="string"?"":b.filterExp.subject;e=typeof b.filterExp.property==="string"?"":b.filterExp.property;f=typeof b.filterExp.object==="string"?"":b.filterExp.object;if(a.queries[c]===undefined)a.queries[c]={};if(a.queries[c][e]===undefined)a.queries[c][e]={};if(a.queries[c][e][f]===undefined)a.queries[c][e][f]=
[];a.queries[c][e][f].push(b)}else d.each(a.union,function(g,h){H(h,b)})},w=function(a){a.length=0;a.matches=[];d.each(a.children,function(b,c){w(c)});d.each(a.partOf,function(b,c){w(c)})},C=function(a,b){if(b.length>0){d.each(a.children,function(c,e){x(e,b)});d.each(a.partOf,function(c,e){C(e,b)});d.each(b,function(c,e){a.matches.push(e);Array.prototype.push.call(a,e.bindings)})}},Q=function(a,b){var c,e,f,g,h,i,l=b.length,q={},m={},P={},I=[];for(c=0;c<a.length;c+=1){e=a[c].bindings;f=a[c].triples;
m=P;for(g=0;g<l;g+=1){h=b[g];i=e[h];if(g===l-1)if(m[i]===undefined){q={bindings:{},triples:f};for(h=0;h<l;h+=1)q.bindings[b[h]]=e[b[h]];m[i]=q;I.push(q)}else{q=m[i];q.triples=q.triples.concat(f)}else{if(m[i]===undefined)m[i]={};m=m[i]}}}return I},R=function(a,b){var c,e,f,g={},h=[];for(c=0;c<a.length;c+=1){e=a[c];if(g[e.bindings[b]]===undefined){f={bindings:{node:e.bindings[b]},triples:e.triples};h.push(f);g[e.bindings[b]]=f}else{f=g[e.bindings[b]];f.triples=f.triples.concat(e.triples)}}return h},
x=function(a,b){var c;if(a.union===undefined)if(a.top||a.parent.top)c=a.alphaMemory;else{b=b||a.parent.matches;c=d.isFunction(a.filterExp)?d.map(b,function(e,f){return a.filterExp.call(e.bindings,f,e.bindings,e.triples)?e:null}):a.filterExp!==undefined?G(b,a.alphaMemory,a.filterExp.optional):b}else c=d.map(a.union,function(e){return e.matches});if(a.selections!==undefined)c=Q(c,a.selections);else if(a.navigate!==undefined)c=R(c,a.navigate);C(a,c)},n=function(a,b){d.each(a,function(c,e){var f;f=e.filterExp.exec(b);
if(f!==null){f={triples:[b],bindings:f};e.alphaMemory.push(f);if(e.filterExp.optional){w(e);x(e)}else{f=e.top||e.parent.top?[f]:G(e.parent.matches,[f],false);C(e,f)}}})},o=function(a,b){d.each(a,function(c,e){e.alphaMemory.splice(d.inArray(b,e.alphaMemory),1);w(e);x(e)})},J=function(a,b){var c=b.subject,e=b.property,f=b.object;if(a.union===undefined){if(a.queries[c]!==undefined){if(a.queries[c][e]!==undefined){a.queries[c][e][f]!==undefined&&n(a.queries[c][e][f],b);a.queries[c][e][""]!==undefined&&
n(a.queries[c][e][""],b)}if(a.queries[c][""]!==undefined){a.queries[c][""][f]!==undefined&&n(a.queries[c][""][f],b);a.queries[c][""][""]!==undefined&&n(a.queries[c][""][""],b)}}if(a.queries[""]!==undefined){if(a.queries[""][e]!==undefined){a.queries[""][e][f]!==undefined&&n(a.queries[""][e][f],b);a.queries[""][e][""]!==undefined&&n(a.queries[""][e][""],b)}if(a.queries[""][""]!==undefined){a.queries[""][""][f]!==undefined&&n(a.queries[""][""][f],b);a.queries[""][""][""]!==undefined&&n(a.queries[""][""][""],
b)}}}else d.each(a.union,function(g,h){J(h,b)})},K=function(a,b){var c=b.subject,e=b.property,f=b.object;if(a.union===undefined){if(a.queries[c]!==undefined){if(a.queries[c][e]!==undefined){a.queries[c][e][f]!==undefined&&o(a.queries[c][e][f],b);a.queries[c][e][""]!==undefined&&o(a.queries[c][e][""],b)}if(a.queries[c][""]!==undefined){a.queries[c][""][f]!==undefined&&o(a.queries[c][""][f],b);a.queries[c][""][""]!==undefined&&o(a.queries[c][""][""],b)}}if(a.queries[""]!==undefined){if(a.queries[""][e]!==
undefined){a.queries[""][e][f]!==undefined&&o(a.queries[""][e][f],b);a.queries[""][e][""]!==undefined&&o(a.queries[""][e][""],b)}if(a.queries[""][""]!==undefined){a.queries[""][""][f]!==undefined&&o(a.queries[""][""][f],b);a.queries[""][""][""]!==undefined&&o(a.queries[""][""][""],b)}}}else d.each(a.union,function(g,h){K(h,b)})},L=function(a,b,c){var e=b[0],f={},g=[],h;c=c||{};if(b.length===0){for(h=0;h<a.length;h+=1)for(v in a[h]){if(c[v]===undefined)c[v]=[];d.isArray(c[v])&&c[v].push(a[h][v])}return[c]}for(h=
0;h<a.length;h+=1){key=a[h][e];if(f[key]===undefined)f[key]=[];f[key].push(a[h])}b=b.splice(1,1);for(v in f){a=d.extend({},c);a[e]=f[v][0][e];g=g.concat(L(f[v],b,a))}return g};dequeue=function(a,b,c,e){var f=r[a.id][b];d.isFunction(f[c])&&f[c].call(a,e);r[a.id][b]=undefined};d.typedValue.types["http://www.w3.org/1999/02/22-rdf-syntax-ns#XMLLiteral"]={regex:/^.*$/m,strip:false,value:function(a){return a}};d.rdf=function(a){return new d.rdf.fn.init(a)};d.rdf.fn=d.rdf.prototype={rdfquery:"1.1",init:function(a){var b;
a=a||{};this.parent=a.parent;this.union=a.union;this.top=this.parent===undefined&&this.union===undefined;if(this.union===undefined)this.databank=a.databank===undefined?this.parent===undefined?d.rdf.databank(a.triples,a):this.parent.databank:a.databank;else{b=d.map(this.union,function(c){return c.databank});b=d.unique(b);this.databank=b[1]!==undefined?d.rdf.databank(undefined,{union:b}):b[0]}this.children=[];this.partOf=[];this.filterExp=a.filter;this.selections=a.distinct;this.navigate=a.navigate;
this.alphaMemory=[];this.matches=[];this.length=0;if(this.filterExp!==undefined){if(!d.isFunction(this.filterExp)){H(this.databank,this);this.alphaMemory=O(this.databank,this.filterExp)}}else if(a.nodes!==undefined){this.alphaMemory=[];for(b=0;b<a.nodes.length;b+=1)this.alphaMemory.push({bindings:{node:a.nodes[b]},triples:[]})}x(this);return this},base:function(a){if(a===undefined)return this.databank.base();else{this.databank.base(a);return this}},prefix:function(a,b){if(b===undefined)return this.databank.prefix(a);
else{this.databank.prefix(a,b);return this}},add:function(a,b){var c,e;if(a.rdfquery!==undefined)if(a.top){e=this.databank.add(a.databank);return c=d.rdf({parent:this.parent,databank:e})}else if(this.top){e=a.databank.add(this.databank);return c=d.rdf({parent:a.parent,databank:e})}else if(this.union===undefined){c=d.rdf({union:[this,a]});this.partOf.push(c);a.partOf.push(c);return c}else{this.union.push(a);a.partOf.push(this)}else{if(typeof a==="string"){b=d.extend({},{base:this.base(),namespaces:this.prefix(),
source:a},b);a=d.rdf.pattern(a,b)}if(a.isFixed())this.databank.add(a.triple(),b);else{c=this;this.each(function(f,g){var h=a.triple(g);h!==null&&c.databank.add(h,b)})}}return this},remove:function(a,b){if(typeof a==="string"){b=d.extend({},{base:this.base(),namespaces:this.prefix()},b);a=d.rdf.pattern(a,b)}if(a.isFixed())this.databank.remove(a.triple(),b);else{query=this;this.each(function(c,e){var f=a.triple(e);f!==null&&query.databank.remove(f,b)})}return this},load:function(a,b){var c=this;b=b||
{};var e=b.success;if(e!==undefined)b.success=function(){e.call(c)};this.databank.load(a,b);return this},except:function(a){return d.rdf({databank:this.databank.except(a.databank)})},where:function(a,b){var c,e,f;b=b||{};if(typeof a==="string"){c=b.base||this.base();e=d.extend({},this.prefix(),b.namespaces||{});f=b.optional||false;a=d.rdf.pattern(a,{namespaces:e,base:c,optional:f})}c=d.rdf(d.extend({},b,{parent:this,filter:a}));this.children.push(c);return c},optional:function(a,b){return this.where(a,
d.extend({},b||{},{optional:true}))},about:function(a,b){return this.where(a+" ?property ?value",b)},filter:function(a,b){var c;c=d.rdf({parent:this,filter:typeof a==="string"?b.constructor===RegExp?function(){return b.test(this[a].value)}:function(){return this[a].type==="literal"?this[a].value===b:this[a]===b}:a});this.children.push(c);return c},node:function(a){if(a.toString().substring(0,1)==="?"){a=a.toString().substring(1);a=d.rdf({parent:this,navigate:a})}else{if(typeof a==="string")a=A(a,
{namespaces:this.prefix(),base:this.base()});a=d.rdf({parent:this,nodes:[a]})}this.children.push(a);return a},find:function(a){return this.where("?node "+a+" ?object",{navigate:"object"})},back:function(a){return this.where("?subject "+a+" ?node",{navigate:"subject"})},group:function(a){d.isArray(a)||(a=[a]);return d(L(this,a))},select:function(a){var b=[],c,e;for(c=0;c<this.length;c+=1)if(a===undefined)b[c]=this[c];else{b[c]={};for(e=0;e<a.length;e+=1)b[c][a[e]]=this[c][a[e]]}return b},describe:function(a){var b,
c,e,f=[];for(b=0;b<a.length;b+=1){e=a[b];if(e.substring(0,1)==="?"){e=e.substring(1);for(c=0;c<this.length;c+=1)f.push(this[c][e])}else f.push(e)}return this.databank.describe(f)},eq:function(a){return this.filter(function(b){return b===a})},reset:function(){for(var a=this;a.parent!==undefined;)a=a.parent;return a},end:function(){return this.parent},size:function(){return this.length},sources:function(){return d(d.map(this.matches,function(a){return[a.triples]}))},dump:function(a){var b=d.map(this.matches,
function(c){return c.triples});a=d.extend({namespaces:this.databank.namespaces,base:this.databank.base},a||{});return d.rdf.dump(b,a)},get:function(a){return a===undefined?d.makeArray(this):this[a]},each:function(a){d.each(this.matches,function(b,c){a.call(c.bindings,b,c.bindings,c.triples)});return this},map:function(a){return d(d.map(this.matches,function(b,c){return a.call(b.bindings,c,b.bindings,b.triples)}))},jquery:function(){return d(this)}};d.rdf.fn.init.prototype=d.rdf.fn;d.rdf.gleaners=
[];d.rdf.parsers={};d.rdf.dump=function(a,b){var c=d.extend({},d.rdf.dump.defaults,b||{}),e=c.format,f=c.serialize,g;g=d.rdf.parsers[e];if(g===undefined){f=[];for(p in d.rdf.parsers)f.push(p);throw"Unrecognised dump format: "+e+". Expected one of "+f.join(", ");}e=g.dump(a,c);return f?g.serialize(e):e};d.rdf.dump.defaults={format:"application/json",serialize:false,indent:false,namespaces:{}};d.fn.rdf=function(a){var b=[];a=a||function(){return this};if(d(this)[0]&&d(this)[0].nodeType===9)return d(this).children("*").rdf(a);
else if(d(this).length>0){b=d(this).map(function(c,e){return d.map(d.rdf.gleaners,function(f){return f.call(d(e),{callback:a})})});return d.rdf({triples:b,namespaces:d(this).xmlns()})}else return d.rdf()};d.extend(d.expr[":"],{about:function(a,b,c){var e=d(a),f=c[3]?e.safeCurie(c[3]):null,g=false;d.each(d.rdf.gleaners,function(h,i){if(g=i.call(e,{about:f}))return null});return g},type:function(a,b,c){var e=d(a),f=c[3]?e.curie(c[3]):null,g=false;d.each(d.rdf.gleaners,function(h,i){if(i.call(e,{type:f})){g=
true;return null}});return g}});d.rdf.databank=function(a,b){return new d.rdf.databank.fn.init(a,b)};d.rdf.databank.fn=d.rdf.databank.prototype={init:function(a,b){var c;a=a||[];b=b||{};databankSeed+=1;this.id="data"+databankSeed.toString(16);y[this.id]=this;if(b.union===undefined){this.queries={};this.tripleStore=[];this.subjectIndex={};this.propertyIndex={};this.objectIndex={};this.baseURI=b.base||d.uri.base();this.namespaces=d.extend({},b.namespaces||{});for(c=0;c<a.length;c+=1)this.add(a[c])}else this.union=
b.union;return this},base:function(a){if(this.union===undefined)if(a===undefined)return this.baseURI;else{this.baseURI=a;return this}else if(a===undefined)return this.union[0].base();else{d.each(this.union,function(b,c){c.base(a)});return this}},prefix:function(a,b){var c={};if(this.union===undefined)if(a===undefined)return this.namespaces;else if(b===undefined)return this.namespaces[a];else{this.namespaces[a]=b;return this}else if(b===undefined){d.each(this.union,function(e,f){d.extend(c,f.prefix())});
return a===undefined?c:c[a]}else{d.each(this.union,function(e,f){f.prefix(a,b)});return this}},add:function(a,b){var c=b&&b.base||this.base(),e=d.extend({},this.prefix(),b&&b.namespaces||{}),f=b&&b.depth||d.rdf.databank.defaults.depth,g=b&&b.proxy||d.rdf.databank.defaults.proxy;if(a===this)return this;else if(a.subjectIndex!==undefined)if(this.union===undefined)return c=d.rdf.databank(undefined,{union:[this,a]});else{this.union.push(a);return this}else{if(typeof a==="string")a=d.rdf.triple(a,{namespaces:e,
base:c,source:a});if(this.union===undefined){if(this.subjectIndex[a.subject]===undefined){this.subjectIndex[a.subject]=[];f>0&&a.subject.type==="uri"&&this.load(a.subject.value,{depth:f-1,proxy:g})}if(this.propertyIndex[a.property]===undefined){this.propertyIndex[a.property]=[];f>0&&this.load(a.property.value,{depth:f-1,proxy:g})}if(d.inArray(a,this.subjectIndex[a.subject])===-1){this.tripleStore.push(a);this.subjectIndex[a.subject].push(a);this.propertyIndex[a.property].push(a);if(a.object.type===
"uri"||a.object.type==="bnode"){if(this.objectIndex[a.object]===undefined){this.objectIndex[a.object]=[];f>0&&a.object.type==="uri"&&this.load(a.object.value,{depth:f-1,proxy:g})}this.objectIndex[a.object].push(a)}J(this,a)}}else d.each(this.union,function(h,i){i.add(a)});return this}},remove:function(a,b){var c=b&&b.base||this.base(),e=d.extend({},this.prefix(),b&&b.namespaces||{});if(typeof a==="string")a=d.rdf.triple(a,{namespaces:e,base:c,source:a});this.tripleStore.splice(d.inArray(a,this.tripleStore),
1);c=this.subjectIndex[a.subject];c!==undefined&&c.splice(d.inArray(a,c),1);c=this.propertyIndex[a.property];c!==undefined&&c.splice(d.inArray(a,c),1);if(a.object.type==="uri"||a.object.type==="bnode"){c=this.objectIndex[a.object];c!==undefined&&c.splice(d.inArray(a,c),1)}K(this,a);return this},except:function(a){var b=a.subjectIndex,c=[];d.each(this.subjectIndex,function(e,f){var g=b[e];if(g===undefined)c=c.concat(f);else d.each(f,function(h,i){d.inArray(i,g)===-1&&c.push(i)})});return d.rdf.databank(c)},
triples:function(){var a=[];if(this.union===undefined)a=this.tripleStore;else{d.each(this.union,function(b,c){a=a.concat(c.triples().get())});a=d.unique(a)}return d(a)},size:function(){return this.triples().length},describe:function(a){for(var b,c,e,f={},g=[];a.length>0;){c=a.pop();if(f[c]===undefined){if(c.value===undefined)c=d.rdf.resource(c);if(this.subjectIndex[c]!==undefined)for(b=0;b<this.subjectIndex[c].length;b+=1){e=this.subjectIndex[c][b];g.push(e);e.object.type==="bnode"&&a.push(e.object)}if(this.objectIndex[c]!==
undefined)for(b=0;b<this.objectIndex[c].length;b+=1){e=this.objectIndex[c][b];g.push(e);e.subject.type==="bnode"&&a.push(e.subject)}f[c]=true}}return d.unique(g)},dump:function(a){a=d.extend({namespaces:this.namespaces,base:this.base},a||{});return d.rdf.dump(this.triples(),a)},load:function(a,b){var c,e,f=b&&b.format;c=b&&b.async||d.rdf.databank.defaults.async;var g=b&&b.success||d.rdf.databank.defaults.success,h=b&&b.error||d.rdf.databank.defaults.error,i=b&&b.proxy||d.rdf.databank.defaults.proxy,
l=b&&b.depth||d.rdf.databank.defaults.depth;e=typeof a==="string"&&a.substring(1,7)==="http://"?d.uri(a):a;if(e.scheme){f={success:g,error:h};if(r[this.id]===undefined)r[this.id]={};if(r[this.id][e]===undefined){r[this.id][e]=f;f=false}else f=true;if(!f){e='<script type="text/javascript" src="'+i+"?id="+this.id+"&amp;depth="+l+"&amp;url="+encodeURIComponent(e.resolve("").toString())+'"><\/script>';c?setTimeout("$('head').append('"+e+"')",0):d("head").append(e)}}else{if(f===undefined)if(typeof a===
"string")f=a.substring(0,1)==="{"?"application/json":a.substring(0,14)==="<!DOCTYPE html"||a.substring(0,5)==="<html"?"application/xhtml+xml":a.substring(0,5)==="<?xml"||a.substring(0,8)==="<rdf:RDF"?"application/rdf+xml":"text/turtle";else if(a.documentElement||a.ownerDocument){c=a.documentElement?a.documentElement:a.ownerDocument.documentElement;f=c.nodeName==="html"?"application/xhtml+xml":"application/rdf+xml"}else f="application/json";c=d.rdf.parsers[f];if(typeof a==="string")a=c.parse(a);e=
c.triples(a);for(c=0;c<e.length;c+=1)this.add(e[c],b)}return this},toString:function(){return"[Databank with "+this.size()+" triples]"}};d.rdf.databank.fn.init.prototype=d.rdf.databank.fn;d.rdf.databank.defaults={parse:false,async:true,success:null,error:null,depth:0,proxy:"http://www.jenitennison.com/rdfquery/proxy.php"};d.rdf.databank.load=function(a,b,c,e){c!==undefined&&y[a].load(c,e);dequeue(y[a],b,c===undefined?"error":"success",e)};d.rdf.pattern=function(a,b,c,e){var f;if(c===undefined){e=
b||{};c=d.trim(a).match(D);if(c.length===3||c.length===4&&c[3]==="."){a=c[0];b=c[1];c=c[2]}else throw"Bad Pattern: Couldn't parse string "+a;f=e.optional===undefined?d.rdf.pattern.defaults.optional:e.optional}if(k[a]&&k[a][b]&&k[a][b][c]&&k[a][b][c][f])return k[a][b][c][f];a=new d.rdf.pattern.fn.init(a,b,c,e);if(k[a.subject]&&k[a.subject][a.property]&&k[a.subject][a.property][a.object]&&k[a.subject][a.property][a.object][a.optional])return k[a.subject][a.property][a.object][a.optional];else{if(k[a.subject]===
undefined)k[a.subject]={};if(k[a.subject][a.property]===undefined)k[a.subject][a.property]={};if(k[a.subject][a.property][a.object]===undefined)k[a.subject][a.property][a.object]={};return k[a.subject][a.property][a.object][a.optional]=a}};d.rdf.pattern.fn=d.rdf.pattern.prototype={init:function(a,b,c,e){e=d.extend({},d.rdf.pattern.defaults,e);this.subject=a.toString().substring(0,1)==="?"?a:z(a,e);this.property=b.toString().substring(0,1)==="?"?b:F(b,e);this.object=c.toString().substring(0,1)==="?"?
c:A(c,e);this.optional=e.optional;return this},fill:function(a){var b=this.subject,c=this.property,e=this.object;if(typeof b==="string"&&a[b.substring(1)])b=a[b.substring(1)];if(typeof c==="string"&&a[c.substring(1)])c=a[c.substring(1)];if(typeof e==="string"&&a[e.substring(1)])e=a[e.substring(1)];return d.rdf.pattern(b,c,e,{optional:this.optional})},exec:function(a){var b={};b=B(a.subject,this.subject,b);if(b===null)return null;b=B(a.property,this.property,b);if(b===null)return null;return b=B(a.object,
this.object,b)},isFixed:function(){return typeof this.subject!=="string"&&typeof this.property!=="string"&&typeof this.object!=="string"},triple:function(a){var b=this;this.isFixed()||(b=this.fill(a));return b.isFixed()?d.rdf.triple(b.subject,b.property,b.object,{source:this.toString()}):null},toString:function(){return this.subject+" "+this.property+" "+this.object}};d.rdf.pattern.fn.init.prototype=d.rdf.pattern.fn;d.rdf.pattern.defaults={base:d.uri.base(),namespaces:{},optional:false};d.rdf.triple=
function(a,b,c,e){var f;if(c===undefined){e=b;f=d.trim(a).match(D);if(f.length===3||f.length===4&&f[3]==="."){a=f[0];b=f[1];c=f[2]}else throw"Bad Triple: Couldn't parse string "+a;}f=e&&e.graph||"";if(j[f]&&j[f][a]&&j[f][a][b]&&j[f][a][b][c])return j[f][a][b][c];a=new d.rdf.triple.fn.init(a,b,c,e);f=a.graph||"";if(j[f]&&j[f][a.subject]&&j[f][a.subject][a.property]&&j[f][a.subject][a.property][a.object])return j[f][a.subject][a.property][a.object];else{if(j[f]===undefined)j[f]={};if(j[f][a.subject]===
undefined)j[f][a.subject]={};if(j[f][a.subject][a.property]===undefined)j[f][a.subject][a.property]={};return j[f][a.subject][a.property][a.object]=a}};d.rdf.triple.fn=d.rdf.triple.prototype={init:function(a,b,c,e){e=d.extend({},d.rdf.triple.defaults,e);this.subject=z(a,e);this.property=F(b,e);this.object=A(c,e);this.graph=e.graph===undefined?undefined:z(e.graph,e);this.source=e.source;return this},isFixed:function(){return true},triple:function(){return this},dump:function(){var a={},b=this.subject.value.toString(),
c=this.property.value.toString();a[b]={};a[b][c]=this.object.dump();return a},toString:function(){return this.subject+" "+this.property+" "+this.object+" ."}};d.rdf.triple.fn.init.prototype=d.rdf.triple.fn;d.rdf.triple.defaults={base:d.uri.base(),source:[document],namespaces:{}};d.rdf.resource=function(a,b){var c;if(s[a])return s[a];c=new d.rdf.resource.fn.init(a,b);if(s[c])return s[c];else return s[c]=c};d.rdf.resource.fn=d.rdf.resource.prototype={type:"uri",value:undefined,init:function(a,b){var c,
e;if(typeof a==="string"){c=M.exec(a);e=d.extend({},d.rdf.resource.defaults,b);if(c!==null)this.value=d.uri.resolve(c[1].replace(/\\>/g,">"),e.base);else if(a.substring(0,1)===":"){e=e.namespaces[""];if(e===undefined)throw"Malformed Resource: No namespace binding for default namespace in "+a;else this.value=d.uri.resolve(e+a.substring(1))}else if(a.substring(a.length-1)===":"){c=a.substring(0,a.length-1);e=e.namespaces[c];if(e===undefined)throw"Malformed Resource: No namespace binding for prefix "+
c+" in "+a;else this.value=d.uri.resolve(e)}else try{this.value=d.curie(a,{namespaces:e.namespaces})}catch(f){throw"Malformed Resource: Bad format for resource "+f;}}else this.value=a;return this},dump:function(){return{type:"uri",value:this.value.toString()}},toString:function(){return"<"+this.value+">"}};d.rdf.resource.fn.init.prototype=d.rdf.resource.fn;d.rdf.resource.defaults={base:d.uri.base(),namespaces:{}};d.rdf.type=d.rdf.resource("<http://www.w3.org/1999/02/22-rdf-syntax-ns#type>");d.rdf.label=
d.rdf.resource("<http://www.w3.org/2000/01/rdf-schema#label>");d.rdf.first=d.rdf.resource("<http://www.w3.org/1999/02/22-rdf-syntax-ns#first>");d.rdf.rest=d.rdf.resource("<http://www.w3.org/1999/02/22-rdf-syntax-ns#rest>");d.rdf.nil=d.rdf.resource("<http://www.w3.org/1999/02/22-rdf-syntax-ns#nil>");d.rdf.subject=d.rdf.resource("<http://www.w3.org/1999/02/22-rdf-syntax-ns#subject>");d.rdf.property=d.rdf.resource("<http://www.w3.org/1999/02/22-rdf-syntax-ns#property>");d.rdf.object=d.rdf.resource("<http://www.w3.org/1999/02/22-rdf-syntax-ns#object>");
d.rdf.blank=function(a){if(t[a])return t[a];a=new d.rdf.blank.fn.init(a);if(t[a])return t[a];else return t[a]=a};d.rdf.blank.fn=d.rdf.blank.prototype={type:"bnode",value:undefined,id:undefined,init:function(a){if(a==="[]"){E+=1;this.id="b"+E.toString(16);this.value="_:"+this.id}else if(a.substring(0,2)==="_:"){this.id=a.substring(2);this.value=a}else throw"Malformed Blank Node: "+a+" is not a legal format for a blank node";return this},dump:function(){return{type:"bnode",value:this.value}},toString:function(){return this.value}};
d.rdf.blank.fn.init.prototype=d.rdf.blank.fn;d.rdf.literal=function(a,b){var c;if(u[a])return u[a];c=new d.rdf.literal.fn.init(a,b);if(u[c])return u[c];else return u[c]=c};d.rdf.literal.fn=d.rdf.literal.prototype={type:"literal",value:undefined,lang:undefined,datatype:undefined,init:function(a,b){var c,e=d.extend({},d.rdf.literal.defaults,b);c=d.safeCurie(e.datatype,{namespaces:e.namespaces});if(e.lang!==undefined&&e.datatype!==undefined&&c.toString()!=="http://www.w3.org/1999/02/22-rdf-syntax-ns#XMLLiteral")throw"Malformed Literal: Cannot define both a language and a datatype for a literal ("+
a+")";if(e.datatype!==undefined){c=d.safeCurie(e.datatype,{namespaces:e.namespaces});d.extend(this,d.typedValue(a.toString(),c));if(c.toString()==="http://www.w3.org/1999/02/22-rdf-syntax-ns#XMLLiteral")this.lang=e.lang}else if(e.lang!==undefined){this.value=a.toString();this.lang=e.lang}else if(typeof a==="boolean")d.extend(this,d.typedValue(a.toString(),"http://www.w3.org/2001/XMLSchema#boolean"));else if(typeof a==="number")d.extend(this,d.typedValue(a.toString(),"http://www.w3.org/2001/XMLSchema#double"));
else if(a==="true"||a==="false")d.extend(this,d.typedValue(a,"http://www.w3.org/2001/XMLSchema#boolean"));else if(d.typedValue.valid(a,"http://www.w3.org/2001/XMLSchema#integer"))d.extend(this,d.typedValue(a,"http://www.w3.org/2001/XMLSchema#integer"));else if(d.typedValue.valid(a,"http://www.w3.org/2001/XMLSchema#decimal"))d.extend(this,d.typedValue(a,"http://www.w3.org/2001/XMLSchema#decimal"));else if(d.typedValue.valid(a,"http://www.w3.org/2001/XMLSchema#double")&&!/^\s*([\-\+]?INF|NaN)\s*$/.test(a))d.extend(this,
d.typedValue(a,"http://www.w3.org/2001/XMLSchema#double"));else{c=N.exec(a);if(c!==null){this.value=(c[2]||c[4]).replace(/\\"/g,'"').replace(/\\n/g,"\n").replace(/\\t/g,"\t").replace(/\\r/g,"\r");if(c[9]){c=d.rdf.resource(c[9],e);d.extend(this,d.typedValue(this.value,c.value))}else if(c[7])this.lang=c[7]}else throw"Malformed Literal: Couldn't recognise the value "+a;}return this},dump:function(){var a={type:"literal",value:this.value.toString()};if(this.lang!==undefined)a.lang=this.lang;else if(this.datatype!==
undefined)a.datatype=this.datatype.toString();return a},toString:function(){var a='"'+this.value+'"';if(this.lang!==undefined)a+="@"+this.lang;else if(this.datatype!==undefined)a+="^^<"+this.datatype+">";return a}};d.rdf.literal.fn.init.prototype=d.rdf.literal.fn;d.rdf.literal.defaults={base:d.uri.base(),namespaces:{},datatype:undefined,lang:undefined}})(jQuery);
